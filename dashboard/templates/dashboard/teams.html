{% extends "dashboard/base_dashboard.html" %}

{% block title %}Dashboard - Team{% endblock %}

{% block content %}
<div class="p-6">
  <div class="flex justify-between items-center mb-6">
    <div>
      <h1 class="text-2xl font-semibold">Teams</h1>
      <p class="text-gray-500 text-sm">Manage all registered users, their activity, and verification status.</p>
    </div>
    <button id="addTeamBtn" class="bg-orange-400 hover:bg-orange-500 text-white px-4 py-2 rounded-lg shadow">
      + Add Team
    </button>
  </div>

  <!-- Table -->
  <div class="bg-white shadow rounded-lg ">
    <table class="w-full text-left">
      <thead class="bg-gray-100 text-gray-600 uppercase text-sm">
        <tr>
          <th class="py-3 px-4">Name</th>
          <th class="py-3 px-4">Status</th>
          <th class="py-3 px-4 flex gap-2 items-center">Date Added <i style=' width:18px;' data-lucide="arrow-down"></i></th>
          <th class="py-3 px-4">Activity</th>
          <th class="py-3 px-4"></th>
        </tr>
      </thead>
     <tbody class="text-gray-700">
  {% for member in team_members %}
  <tr class="border-b border-gray-100 hover:bg-gray-50">
    <td class="py-3 px-4 font-medium">{{ member.name }}</td>
    
    <td class="py-3 px-4">
      {% if member.status == 'active' %}
        <span class="bg-green-100 text-green-700 px-2 py-1 rounded text-xs">Active</span>
      {% else %}
        <span class="bg-red-100 text-red-700 px-2 py-1 rounded text-xs">Offline</span>
      {% endif %}
    </td>
    <td class="py-3 px-4">{{ member.created_at|date:"M d Y" }}</td>
    <td class="py-3 px-4 relative">
      
      {% if member.verified == True %}
        <button
        class="bg-green-100 text-green-700 px-2 py-1 rounded"
      >
        Verified
       
      </button>
      {% else %}
       <a href="{% url 'verify_user' member.id %}"
        class=" text-green-700 hover:underline gap-1"
      >
        Verify users
        
    </a>
      {% endif %}
    </td>
    <td class="py-3 px-4 flex justify-end items-center pr-16 gap-6">
      <button class="text-gray-500"><i data-lucide="message-square-more"></i></button>
      <a href="{% url 'delete_admin' member.id %}" 
   onclick="return confirm('Are you sure you want to delete this user?')"class="text-gray-500"><i data-lucide="trash"></i></button>
    </td>
  </tr>
  {% empty %}
  <tr>
    <td colspan="5" class="py-4 px-4 text-center text-gray-500">No team members found.</td>
  </tr>
  {% endfor %}
</tbody>

    </table>

  </div>
</div>

<!-- Include modal partial -->
{% include 'dashboard/partials/add_team_modal.html' %}
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
  const dropdownBtn = document.getElementById('dropdownBtn');
  const dropdownMenu = document.getElementById('dropdownMenu');

  dropdownBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    dropdownMenu.classList.toggle('hidden');
  });

  // Close dropdown if you click outside
  document.addEventListener('click', () => {
    dropdownMenu.classList.add('hidden');
  });
});
   

document.addEventListener('DOMContentLoaded', function () {
    
  const addBtn = document.getElementById('addTeamBtn');
  const closeBtn = document.getElementById('closeModalBtn');
  const modal = document.getElementById('addTeamModal');

  if (addBtn && modal && closeBtn) {
    addBtn.addEventListener('click', () => modal.classList.remove('hidden'));
    closeBtn.addEventListener('click', () => modal.classList.add('hidden'));
  } else {
    console.error("Some modal elements were not found.");
  }


});
</script>
{% endblock %}
